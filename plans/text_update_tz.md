# Техническое задание: Обновление текстов и микро-копирайтинга (Задача 4)

## 1. Цель
Привести все тексты интерфейса админ-панели и уведомлений в соответствие с единым стилем и глоссарием, описанным в [Задача 4.md](Задача 4.md).

## 2. Глоссарий статусов (Единый для всего проекта)

### 2.1 Статусы этапов (Stages)
| Код | Текст в UI |
| :--- | :--- |
| `pending` | В ожидании |
| `queued` | В очереди |
| `processing` | В работе |
| `completed` | Готово |
| `failed` | Ошибка |
| `cancelled` | Отменён |

### 2.2 Статусы заказа (Order)
| Код | Текст в UI |
| :--- | :--- |
| `new` | Новый |
| `in_progress` | В обработке |
| `completed` | Завершён |
| `failed` | Ошибка |
| `canceled` | Отменён |
| `waiting_payment` | Ожидает оплату |

### 2.3 Статусы ключа (LLM Keys)
| Код | Текст в UI | Подсказка |
| :--- | :--- | :--- |
| `active` | Активен | Используется сейчас |
| `inactive` | Отключён | Не используется |
| `needs_check` | Требует проверки | Нажмите «Проверить ключ» |
| `invalid` | Не работает | Проверьте ключ/провайдера |
| `quota_exceeded` | Квота исчерпана | Проверьте лимиты/баланс |

## 3. Изменения по страницам

### 3.1 Общий макет ([layout.html](app/web/templates/layout.html))
- Изменить заголовок в навигации: `Funnel Admin` -> `Creative Funnel Admin`.
- Подвал: Обновить текст копирайта.

### 3.2 Конфигурация LLM ([providers.html](app/web/templates/providers.html))
- **Заголовки**:
  - `Основная настройка` -> `Провайдер и API-ключ`.
- **Поля и подсказки**:
  - API-ключ: плейсхолдер `Вставьте API-ключ`.
  - Добавить Helper text под ключом: `Ключ хранится безопасно. Можно заменить в любой момент.`
  - Креативность: Добавить Helper: `Низкая — точнее, высокая — смелее формулировки.`
- **Кнопки**:
  - `Сохранить конфигурацию` -> `Сохранить провайдер и ключ`.
- **История ключей**:
  - Обновить заголовки колонок (Ключ (маска), Провайдер, Статус, Последняя проверка, Действия).
  - Применить маппинг статусов из глоссария.

### 3.3 Детали заказа ([order_detail.html](app/web/templates/order_detail.html))
- **Шапка**:
  - `Заказ #ID` -> `Заказ № ID`.
  - Добавить подзаголовок: `Создан: {date} · Обновлён: {date}`.
- **Блок "Сводка"** (вместо "Информация о заказе"):
  - Поля: Статус заказа, Оплата, Итоговая сумма, Провайдер, Модель.
  - Убрать техническое поле `ID пользователя`.
- **Блок "Параметры генерации"** (п. 3.65):
  - Удалить сырой вывод JSON.
  - Вывести только разрешенные поля: `Повод`, `Кому`, `Детали`.
- **Таблица этапов**:
  - Применить маппинг статусов из глоссария.
  - Кнопки: `Перезапустить`, `Отменить`.
  - Добавить тултипы для кнопок из требований.

## 4. Техническая реализация
- Создать файл `app/web/texts.py` (или использовать существующий механизм, если есть) для централизованного хранения строк.
- В шаблонах заменить жестко заданные строки на переменные или вызовы функций перевода.
- Исправить ошибку `jinja2.exceptions.UndefinedError: 'active_config' is undefined` в `providers_list`.

## 5. План внедрения
1. Создание словаря текстов.
2. Обновление `app/web/routes/admin.py` для передачи корректных данных и статусов.
3. Рефакторинг HTML-шаблонов.
4. Тестирование отображения на разных статусах.