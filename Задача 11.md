Задание для IDE: убрать “белый экран” после Save и делать redirect обратно
Проблема

На страницах админки есть формы с кнопкой Сохранить, которые отправляют POST на update-эндпоинты. Например:

В “Продукты” каждая строка формы отправляет POST /admin/products/update. 

products

В “Конфигурация LLM” форма отправляет POST /admin/providers/update. 

providers

Сейчас после сохранения сервер возвращает JSON {"status":"ok"}, из-за чего браузер показывает “белую страницу” со статусом, вместо того чтобы остаться в админке.

Цель

После нажатия Сохранить:

не показывать JSON/белый экран

возвращать пользователя назад на страницу, откуда он нажал “Сохранить” (или просто обновлять её)

поведение должно быть единым для всех “save/update” форм в админке (в т.ч. будущих)

Требования к реализации
1) Изменить ответ update-эндпоинтов

Для всех POST эндпоинтов админки, которые обслуживают HTML-формы (в первую очередь):

POST /admin/products/update 

products

POST /admin/providers/update 

providers

после успешного сохранения возвращать RedirectResponse на страницу-источник:

брать URL из request.headers["referer"]

если referer отсутствует — использовать fallback:

для products: /admin/products

для providers: /admin/providers

использовать status_code=303 (Post/Redirect/Get), чтобы после POST браузер делал GET и не было повторной отправки формы при обновлении.

2) Сохранить возможность JSON для API (опционально, но правильно)

Если эти же эндпоинты могут вызываться не из браузерной формы, добавить простую развилку:

если запрос ожидает HTML (Accept содержит text/html) → redirect

иначе → можно вернуть JSON { "status": "ok" } (для интеграций/скриптов)

3) Общее решение “на все save”

Сделать общий helper (функцию), например redirect_back(request, fallback_url) и использовать его во всех админских update/save POST-обработчиках, чтобы не размазывать логику.

Acceptance Criteria (что считаем “готово”)

На странице “Продукты” при нажатии Сохранить:

данные сохраняются

страница не заменяется на JSON

пользователь остаётся на /admin/products (страница обновляется/перезагружается) 

products

На странице “Конфигурация LLM” при нажатии Сохранить:

данные сохраняются

происходит redirect назад на /admin/providers (без белого экрана) 

providers

После обновления страницы (F5) браузер не показывает предупреждение “Повторить отправку формы” (признак, что PRG работает → 303).

Примечания по UX (не обязательно, но полезно)

Если хочется подтверждение “Сохранено”, можно:

редиректить на ... ?saved=1

и на фронте (в layout.html уже есть helper showToast(...)) показать toast при наличии saved=1. 

layout


Это опционально — главное убрать JSON-экран.